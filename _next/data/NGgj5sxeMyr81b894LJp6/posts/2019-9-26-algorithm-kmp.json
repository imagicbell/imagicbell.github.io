{"pageProps":{"post":{"title":"Algorithm Notes: KMP","date":"2019-09-26T20:00:00+08:00","slug":"2019-9-26-algorithm-kmp","categories":["Algorithm"],"readTime":10,"content":"<h3 id=\"section-background\">Background</h3>\n<p>String searching is one of the most common interview problems. Of course, it can be solved by using the simple way that every body can work out, which is: </p>\n<ul>\n<li>Compare the template string to the target one by one character.</li>\n<li>When meet the difference, come back to the start of the template string and the next character of the last start of the target string\". </li>\n</ul>\n<p>The time complexity is <span><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>m</mi><mo>×</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(m \\times n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span style=\"margin-right: 0.02778em;\" class=\"mord mathdefault\">O</span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">m</span><span class=\"mspace\" style=\"margin-right: 0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right: 0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathdefault\">n</span><span class=\"mclose\">)</span></span></span></span></span>, that is obviously not good. If we can solve it using KMP(Knuth–Morris–Pratt string-searching algorithm), maybe we can stand out in the interviews.</p>\n<h3 id=\"section-how-to\">How To</h3>\n<p>The key point of KMP is to avoid the repeated comparisons. We'll take an example to illustrate how.</p>\n<p>Consider to find the first occurance of string <code>w</code> = \"ABCDABD\" in string <code>s</code> = \"ABCDABCDABDE\".</p>\n<table>\n<thead>\n<tr>\n<th id=\"s\" style=\"text-align:center;\">s</th>\n<th id=\"a\" style=\"text-align:center;\">A</th>\n<th id=\"b\" style=\"text-align:center;\">B</th>\n<th id=\"c\" style=\"text-align:center;\">C</th>\n<th id=\"d\" style=\"text-align:center;\">D</th>\n<th id=\"a\" style=\"text-align:center;\">A</th>\n<th id=\"b\" style=\"text-align:center;\">B</th>\n<th id=\"<span_style=\" color:red\"=\"\">c\" style=\"text-align:center;\"&gt;<span style=\"color:red\">C</span></th>\n<th id=\"d\" style=\"text-align:center;\">D</th>\n<th id=\"a\" style=\"text-align:center;\">A</th>\n<th id=\"b\" style=\"text-align:center;\">B</th>\n<th id=\"d\" style=\"text-align:center;\">D</th>\n<th id=\"e\" style=\"text-align:center;\">E</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center;\">i</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">1</td>\n<td style=\"text-align:center;\">2</td>\n<td style=\"text-align:center;\">3</td>\n<td style=\"text-align:center;\">4</td>\n<td style=\"text-align:center;\">5</td>\n<td style=\"text-align:center;\"><span style=\"color:red\">6</span></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center;\">w</td>\n<td style=\"text-align:center;\">A</td>\n<td style=\"text-align:center;\">B</td>\n<td style=\"text-align:center;\">C</td>\n<td style=\"text-align:center;\">D</td>\n<td style=\"text-align:center;\">A</td>\n<td style=\"text-align:center;\">B</td>\n<td style=\"text-align:center;\"><span style=\"color:red\">D</span></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center;\">j</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">1</td>\n<td style=\"text-align:center;\">2</td>\n<td style=\"text-align:center;\">3</td>\n<td style=\"text-align:center;\">4</td>\n<td style=\"text-align:center;\">5</td>\n<td style=\"text-align:center;\"><span style=\"color:red\">6</span></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n</tr>\n</tbody>\n</table>\n<p>When compared to the sixth character, we meet the difference. Now <code>i = 6</code>, <code>j = 6</code>.</p>\n<p>We'll introduce a <strong>Partial Match Table</strong>, <strong>PMT</strong> in short. It will be explained later in this article.</p>\n<table>\n<thead>\n<tr>\n<th id=\"w\" style=\"text-align:center;\">w</th>\n<th id=\"a\" style=\"text-align:center;\">A</th>\n<th id=\"b\" style=\"text-align:center;\">B</th>\n<th id=\"c\" style=\"text-align:center;\">C</th>\n<th id=\"d\" style=\"text-align:center;\">D</th>\n<th id=\"a\" style=\"text-align:center;\">A</th>\n<th id=\"<span_style=\" color:red\"=\"\">b\" style=\"text-align:center;\"&gt;<span style=\"color:red\">B</span></th>\n<th id=\"d\" style=\"text-align:center;\">D</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center;\">PMT</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">1</td>\n<td style=\"text-align:center;\"><span style=\"color:red\">2</span></td>\n<td style=\"text-align:center;\">0</td>\n</tr>\n</tbody>\n</table>\n<p>According to the PMT, we move j to 2, keep i unchanged, and we get:</p>\n<table>\n<thead>\n<tr>\n<th id=\"s\" style=\"text-align:center;\">s</th>\n<th id=\"a\" style=\"text-align:center;\">A</th>\n<th id=\"b\" style=\"text-align:center;\">B</th>\n<th id=\"c\" style=\"text-align:center;\">C</th>\n<th id=\"d\" style=\"text-align:center;\">D</th>\n<th id=\"a\" style=\"text-align:center;\">A</th>\n<th id=\"b\" style=\"text-align:center;\">B</th>\n<th id=\"<span_style=\" color:red\"=\"\">c\" style=\"text-align:center;\"&gt;<span style=\"color:red\">C</span></th>\n<th id=\"d\" style=\"text-align:center;\">D</th>\n<th id=\"a\" style=\"text-align:center;\">A</th>\n<th id=\"b\" style=\"text-align:center;\">B</th>\n<th id=\"d\" style=\"text-align:center;\">D</th>\n<th id=\"e\" style=\"text-align:center;\">E</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center;\">i</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">1</td>\n<td style=\"text-align:center;\">2</td>\n<td style=\"text-align:center;\">3</td>\n<td style=\"text-align:center;\">4</td>\n<td style=\"text-align:center;\">5</td>\n<td style=\"text-align:center;\"><span style=\"color:red\">6</span></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center;\">w</td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\">A</td>\n<td style=\"text-align:center;\">B</td>\n<td style=\"text-align:center;\"><span style=\"color:red\">C</span></td>\n<td style=\"text-align:center;\">D</td>\n<td style=\"text-align:center;\">A</td>\n<td style=\"text-align:center;\">B</td>\n<td style=\"text-align:center;\">D</td>\n<td style=\"text-align:center;\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center;\">j</td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">1</td>\n<td style=\"text-align:center;\"><span style=\"color:red\">2</span></td>\n<td style=\"text-align:center;\">3</td>\n<td style=\"text-align:center;\">4</td>\n<td style=\"text-align:center;\">5</td>\n<td style=\"text-align:center;\">6</td>\n<td style=\"text-align:center;\"></td>\n</tr>\n</tbody>\n</table>\n<p>Then continue to compare, and we'll find the match.</p>\n<p>So the process of KMP is:</p>\n<ol>\n<li>Cursor <code>i</code> of target string <code>s</code> and <code>j</code> of template string <code>w</code> both start from 0, and compare characters of <code>s</code> and <code>w</code> one by one;</li>\n<li>When difference appears, move <code>j</code> to the value of <code>PMT[j-1]</code>. If <code>j==0</code>, just keep <code>j=0</code>;</li>\n<li>Continue to compare. Once reach the end of string <code>w</code>, the match is found and return <code>i-j</code>. Otherwise, return -1.</li>\n</ol>\n<p>Code is as follows:</p>\n<pre><code class=\"javascript language-javascript\">function KMP(s, w) {\n  let i = 0, j = 0;\n  while (i &lt; s.length &amp;&amp; j &lt; w.length) {\n    if (s[i] === w[j]) {\n      i++;\n      j++;\n      if (j === w.length) {\n        return i - j;\n      }\n    } else if (j &gt; 0) {\n      j = pmt[j-1];\n    } else {\n      i++;\n    }\n  }\n  return -1;\n}</code></pre>\n<h3 id=\"section-partial-match-table\">Partial Match Table</h3>\n<p>Now let's explain the PMT. First we'll introduce <strong>prefix</strong> and <strong>suffix</strong>. Also take the <code>w = 'ABCDABD'</code> as example.</p>\n<p><strong>Prefix</strong>: all substrings from 0 to second last character. <code>'A', 'AB', 'ABC', 'ABCD', 'ABCDA', 'ABCDAB'</code>.</p>\n<p><strong>Suffix</strong>: all substrings from 1 to last character. <code>'D', 'BD', 'ABD', 'DABD', 'CDABD', 'BCDABD'</code>.</p>\n<p>The PMT value is the length of the longest same string between prefix and suffix. So we get:</p>\n<table>\n<thead>\n<tr>\n<th id=\"w\" style=\"text-align:center;\">w</th>\n<th id=\"a\" style=\"text-align:center;\">A</th>\n<th id=\"b\" style=\"text-align:center;\">B</th>\n<th id=\"c\" style=\"text-align:center;\">C</th>\n<th id=\"d\" style=\"text-align:center;\">D</th>\n<th id=\"a\" style=\"text-align:center;\">A</th>\n<th id=\"b\" style=\"text-align:center;\">B</th>\n<th id=\"d\" style=\"text-align:center;\">D</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center;\">PMT</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">1</td>\n<td style=\"text-align:center;\">2</td>\n<td style=\"text-align:center;\">0</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li><code>'A'</code> has no prefix or suffix, so PMT value is 0;</li>\n<li><code>'AB'</code> has prefix of <code>'A'</code> and suffix of <code>'B'</code>, no same, so PMT value is 0;</li>\n<li>…</li>\n<li><code>'ABCDA'</code> has prefix of <code>'A','AB','ABC', 'ABCD'</code> and suffix of <code>'A', 'DA', 'CDA', 'BCDA'</code> , longest same <code>'A'</code>, so PMT value is 1;</li>\n<li><code>'ABCDAB'</code> has prefix of <code>'A','AB','ABC', 'ABCD', 'ABCDA'</code> and suffix of <code>'B', 'AB', 'DAB', 'CDAB', 'BCDAB'</code>, longest same<code>'AB'</code>, so PMT value is 2;</li>\n<li>…</li>\n</ul>\n<p>Code is as follows:</p>\n<pre><code class=\"javascript language-javascript\">function PMT(w) {\n  let pmt = new Array(w.length).fill(0);\n  let i = 1, j = 0;\n  while (i &lt; w.length) {\n    if (w[i] === w[j]) {\n      i++;\n      j++;\n      pmt[i] = j;\n    } else if (j &gt; 0) {\n      j = pmt[j-1];\n    } else {\n      pmt[i] = 0;\n      i++;\n    }\n  }\n}</code></pre>\n<p><code>PMT[0]</code> is 0 of course. So we start from the second character, that is <code>i = 1</code>. We consider string <code>w</code> as two strings and try to find the same substring. The second cursor <code>j</code> start from 0.</p>\n<table>\n<thead>\n<tr>\n<th id=\"\" style=\"text-align:center;\"></th>\n<th id=\"a\" style=\"text-align:center;\">A</th>\n<th id=\"<span_style=\" color:red\"=\"\">b\" style=\"text-align:center;\"&gt;<span style=\"color:red\">B</span></th>\n<th id=\"c\" style=\"text-align:center;\">C</th>\n<th id=\"d\" style=\"text-align:center;\">D</th>\n<th id=\"a\" style=\"text-align:center;\">A</th>\n<th id=\"b\" style=\"text-align:center;\">B</th>\n<th id=\"d\" style=\"text-align:center;\">D</th>\n<th id=\"\" style=\"text-align:center;\"></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center;\">i</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\"><span style=\"color:red\">1</span></td>\n<td style=\"text-align:center;\">2</td>\n<td style=\"text-align:center;\">3</td>\n<td style=\"text-align:center;\">4</td>\n<td style=\"text-align:center;\">5</td>\n<td style=\"text-align:center;\">6</td>\n<td style=\"text-align:center;\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"><span style=\"color:red\">A</span></td>\n<td style=\"text-align:center;\">B</td>\n<td style=\"text-align:center;\">C</td>\n<td style=\"text-align:center;\">D</td>\n<td style=\"text-align:center;\">A</td>\n<td style=\"text-align:center;\">B</td>\n<td style=\"text-align:center;\">D</td>\n</tr>\n<tr>\n<td style=\"text-align:center;\">j</td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"><span style=\"color:red\">0</span></td>\n<td style=\"text-align:center;\">1</td>\n<td style=\"text-align:center;\">2</td>\n<td style=\"text-align:center;\">3</td>\n<td style=\"text-align:center;\">4</td>\n<td style=\"text-align:center;\">5</td>\n<td style=\"text-align:center;\">6</td>\n</tr>\n</tbody>\n</table>\n<p><code>A</code> and <code>B</code> is not same, so <code>PMT[1] = 0</code>. Move <code>i</code> to next, and keep <code>j = 0</code>.</p>\n<table>\n<thead>\n<tr>\n<th id=\"\" style=\"text-align:center;\"></th>\n<th id=\"a\" style=\"text-align:center;\">A</th>\n<th id=\"b\" style=\"text-align:center;\">B</th>\n<th id=\"<span_style=\" color:red\"=\"\">c\" style=\"text-align:center;\"&gt;<span style=\"color:red\">C</span></th>\n<th id=\"d\" style=\"text-align:center;\">D</th>\n<th id=\"a\" style=\"text-align:center;\">A</th>\n<th id=\"b\" style=\"text-align:center;\">B</th>\n<th id=\"d\" style=\"text-align:center;\">D</th>\n<th id=\"\" style=\"text-align:center;\"></th>\n<th id=\"\"></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center;\">i</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">1</td>\n<td style=\"text-align:center;\"><span style=\"color:red\">2</span></td>\n<td style=\"text-align:center;\">3</td>\n<td style=\"text-align:center;\">4</td>\n<td style=\"text-align:center;\">5</td>\n<td style=\"text-align:center;\">6</td>\n<td style=\"text-align:center;\"></td>\n<td></td>\n</tr>\n<tr>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"><span style=\"color:red\">A</span></td>\n<td style=\"text-align:center;\">B</td>\n<td style=\"text-align:center;\">C</td>\n<td style=\"text-align:center;\">D</td>\n<td style=\"text-align:center;\">A</td>\n<td style=\"text-align:center;\">B</td>\n<td>D</td>\n</tr>\n<tr>\n<td style=\"text-align:center;\">j</td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"><span style=\"color:red\">0</span></td>\n<td style=\"text-align:center;\">1</td>\n<td style=\"text-align:center;\">2</td>\n<td style=\"text-align:center;\">3</td>\n<td style=\"text-align:center;\">4</td>\n<td style=\"text-align:center;\">5</td>\n<td>6</td>\n</tr>\n</tbody>\n</table>\n<p><code>A</code> and <code>C</code> is not same, so <code>PMT[2] = 0</code>. Move <code>i</code> to next, and keep <code>j = 0</code>.</p>\n<table>\n<thead>\n<tr>\n<th id=\"\" style=\"text-align:center;\"></th>\n<th id=\"a\" style=\"text-align:center;\">A</th>\n<th id=\"b\" style=\"text-align:center;\">B</th>\n<th id=\"c\" style=\"text-align:center;\">C</th>\n<th id=\"<span_style=\" color:red\"=\"\">d\" style=\"text-align:center;\"&gt;<span style=\"color:red\">D</span></th>\n<th id=\"a\" style=\"text-align:center;\">A</th>\n<th id=\"b\" style=\"text-align:center;\">B</th>\n<th id=\"d\" style=\"text-align:center;\">D</th>\n<th id=\"\" style=\"text-align:center;\"></th>\n<th id=\"\"></th>\n<th id=\"\"></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center;\">i</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">1</td>\n<td style=\"text-align:center;\">2</td>\n<td style=\"text-align:center;\"><span style=\"color:red\">3</span></td>\n<td style=\"text-align:center;\">4</td>\n<td style=\"text-align:center;\">5</td>\n<td style=\"text-align:center;\">6</td>\n<td style=\"text-align:center;\"></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"><span style=\"color:red\">A</span></td>\n<td style=\"text-align:center;\">B</td>\n<td style=\"text-align:center;\">C</td>\n<td style=\"text-align:center;\">D</td>\n<td style=\"text-align:center;\">A</td>\n<td>B</td>\n<td>D</td>\n</tr>\n<tr>\n<td style=\"text-align:center;\">j</td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"><span style=\"color:red\">0</span></td>\n<td style=\"text-align:center;\">1</td>\n<td style=\"text-align:center;\">2</td>\n<td style=\"text-align:center;\">3</td>\n<td style=\"text-align:center;\">4</td>\n<td>5</td>\n<td>6</td>\n</tr>\n</tbody>\n</table>\n<p>We get <code>PMT[3] = 0</code>.</p>\n<table>\n<thead>\n<tr>\n<th id=\"\" style=\"text-align:center;\"></th>\n<th id=\"a\" style=\"text-align:center;\">A</th>\n<th id=\"b\" style=\"text-align:center;\">B</th>\n<th id=\"c\" style=\"text-align:center;\">C</th>\n<th id=\"d\" style=\"text-align:center;\">D</th>\n<th id=\"<span_style=\" color:red\"=\"\">a\" style=\"text-align:center;\"&gt;<span style=\"color:red\">A</span></th>\n<th id=\"b\" style=\"text-align:center;\">B</th>\n<th id=\"d\" style=\"text-align:center;\">D</th>\n<th id=\"\" style=\"text-align:center;\"></th>\n<th id=\"\"></th>\n<th id=\"\"></th>\n<th id=\"\"></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center;\">i</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">1</td>\n<td style=\"text-align:center;\">2</td>\n<td style=\"text-align:center;\">3</td>\n<td style=\"text-align:center;\"><span style=\"color:red\">4</span></td>\n<td style=\"text-align:center;\">5</td>\n<td style=\"text-align:center;\">6</td>\n<td style=\"text-align:center;\"></td>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"><span style=\"color:red\">A</span></td>\n<td style=\"text-align:center;\">B</td>\n<td style=\"text-align:center;\">C</td>\n<td style=\"text-align:center;\">D</td>\n<td>A</td>\n<td>B</td>\n<td>D</td>\n</tr>\n<tr>\n<td style=\"text-align:center;\">j</td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"><span style=\"color:red\">0</span></td>\n<td style=\"text-align:center;\">1</td>\n<td style=\"text-align:center;\">2</td>\n<td style=\"text-align:center;\">3</td>\n<td>4</td>\n<td>5</td>\n<td>6</td>\n</tr>\n</tbody>\n</table>\n<p>We get one same character <code>A</code>, so <code>PMT[4] = 1</code>. Now let's move both <code>i</code> and <code>j</code> to next and keep comparing.</p>\n<table>\n<thead>\n<tr>\n<th id=\"\" style=\"text-align:center;\"></th>\n<th id=\"a\" style=\"text-align:center;\">A</th>\n<th id=\"b\" style=\"text-align:center;\">B</th>\n<th id=\"c\" style=\"text-align:center;\">C</th>\n<th id=\"d\" style=\"text-align:center;\">D</th>\n<th id=\"<span_style=\" color:red\"=\"\">a\" style=\"text-align:center;\"&gt;<span style=\"color:red\">A</span></th>\n<th id=\"<span_style=\" color:red\"=\"\">b\" style=\"text-align:center;\"&gt;<span style=\"color:red\">B</span></th>\n<th id=\"d\" style=\"text-align:center;\">D</th>\n<th id=\"\" style=\"text-align:center;\"></th>\n<th id=\"\"></th>\n<th id=\"\"></th>\n<th id=\"\"></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center;\">i</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">1</td>\n<td style=\"text-align:center;\">2</td>\n<td style=\"text-align:center;\">3</td>\n<td style=\"text-align:center;\"><span style=\"color:red\">4</span></td>\n<td style=\"text-align:center;\"><span style=\"color:red\">5</span></td>\n<td style=\"text-align:center;\">6</td>\n<td style=\"text-align:center;\"></td>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"><span style=\"color:red\">A</span></td>\n<td style=\"text-align:center;\"><span style=\"color:red\">B</span></td>\n<td style=\"text-align:center;\">C</td>\n<td style=\"text-align:center;\">D</td>\n<td>A</td>\n<td>B</td>\n<td>D</td>\n</tr>\n<tr>\n<td style=\"text-align:center;\">j</td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"><span style=\"color:red\">0</span></td>\n<td style=\"text-align:center;\"><span style=\"color:red\">1</span></td>\n<td style=\"text-align:center;\">2</td>\n<td style=\"text-align:center;\">3</td>\n<td>4</td>\n<td>5</td>\n<td>6</td>\n</tr>\n</tbody>\n</table>\n<p>Two same characters <code>AB</code>, so <code>PMT[5] = 2</code>. Continue to move <code>i</code> and <code>j</code> to next.</p>\n<table>\n<thead>\n<tr>\n<th id=\"\" style=\"text-align:center;\"></th>\n<th id=\"a\" style=\"text-align:center;\">A</th>\n<th id=\"b\" style=\"text-align:center;\">B</th>\n<th id=\"c\" style=\"text-align:center;\">C</th>\n<th id=\"d\" style=\"text-align:center;\">D</th>\n<th id=\"<span_style=\" color:red\"=\"\">a\" style=\"text-align:center;\"&gt;<span style=\"color:red\">A</span></th>\n<th id=\"<span_style=\" color:red\"=\"\">b\" style=\"text-align:center;\"&gt;<span style=\"color:red\">B</span></th>\n<th id=\"<span_style=\" color:red\"=\"\">d\" style=\"text-align:center;\"&gt;<span style=\"color:red\">D</span></th>\n<th id=\"\" style=\"text-align:center;\"></th>\n<th id=\"\"></th>\n<th id=\"\"></th>\n<th id=\"\"></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center;\">i</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">1</td>\n<td style=\"text-align:center;\">2</td>\n<td style=\"text-align:center;\">3</td>\n<td style=\"text-align:center;\"><span style=\"color:red\">4</span></td>\n<td style=\"text-align:center;\"><span style=\"color:red\">5</span></td>\n<td style=\"text-align:center;\"><span style=\"color:red\">6</span></td>\n<td style=\"text-align:center;\"></td>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"><span style=\"color:red\">A</span></td>\n<td style=\"text-align:center;\"><span style=\"color:red\">B</span></td>\n<td style=\"text-align:center;\"><span style=\"color:red\">C</span></td>\n<td style=\"text-align:center;\">D</td>\n<td>A</td>\n<td>B</td>\n<td>D</td>\n</tr>\n<tr>\n<td style=\"text-align:center;\">j</td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"><span style=\"color:red\">0</span></td>\n<td style=\"text-align:center;\"><span style=\"color:red\">1</span></td>\n<td style=\"text-align:center;\"><span style=\"color:red\">2</span></td>\n<td style=\"text-align:center;\">3</td>\n<td>4</td>\n<td>5</td>\n<td>6</td>\n</tr>\n</tbody>\n</table>\n<p><code>C</code> and <code>D</code> are not same. Like KMP, we keep <code>i</code> unchanged, and move <code>j</code> to <code>PMT[j-1]</code>, which is <code>0</code>.</p>\n<table>\n<thead>\n<tr>\n<th id=\"\" style=\"text-align:center;\"></th>\n<th id=\"a\" style=\"text-align:center;\">A</th>\n<th id=\"b\" style=\"text-align:center;\">B</th>\n<th id=\"c\" style=\"text-align:center;\">C</th>\n<th id=\"d\" style=\"text-align:center;\">D</th>\n<th id=\"a\" style=\"text-align:center;\">A</th>\n<th id=\"b\" style=\"text-align:center;\">B</th>\n<th id=\"<span_style=\" color:red\"=\"\">d\" style=\"text-align:center;\"&gt;<span style=\"color:red\">D</span></th>\n<th id=\"\" style=\"text-align:center;\"></th>\n<th id=\"\"></th>\n<th id=\"\"></th>\n<th id=\"\"></th>\n<th id=\"\"></th>\n<th id=\"\"></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center;\">i</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">1</td>\n<td style=\"text-align:center;\">2</td>\n<td style=\"text-align:center;\">3</td>\n<td style=\"text-align:center;\">4</td>\n<td style=\"text-align:center;\">5</td>\n<td style=\"text-align:center;\"><span style=\"color:red\">6</span></td>\n<td style=\"text-align:center;\"></td>\n<td></td>\n<td></td>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"><span style=\"color:red\">A</span></td>\n<td style=\"text-align:center;\">B</td>\n<td>C</td>\n<td>D</td>\n<td>A</td>\n<td>B</td>\n<td>D</td>\n</tr>\n<tr>\n<td style=\"text-align:center;\">j</td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"></td>\n<td style=\"text-align:center;\"><span style=\"color:red\">0</span></td>\n<td style=\"text-align:center;\">1</td>\n<td>2</td>\n<td>3</td>\n<td>4</td>\n<td>5</td>\n<td>6</td>\n</tr>\n</tbody>\n</table>\n<p>At last we get <code>PMT[6] = 0</code>. But why <code>j = PMT[j - 1]</code>?</p>\n<p>When we meet difference, we will move the string below to the right, which means to move <code>j</code> back. There are <code>j-1, j-2, …, 0</code>. How to decide which is the best move? Remember that the target of <strong>PMT</strong> is to find the longest same prefix and suffix. <code>PMT[j - 1]</code> is the longest length of the same prefix and suffix of <code>'w[0...j-1]'</code>. Let's say</p>\n<span title=\"w_{[0...PMT[j-1]-1]} = w_{[j-PMT[j-1]...j-1]}\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mrow><mo stretchy=\"false\">[</mo><mn>0...</mn><mi>P</mi><mi>M</mi><mi>T</mi><mo stretchy=\"false\">[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo>−</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow></msub><mo>=</mo><msub><mi>w</mi><mrow><mo stretchy=\"false\">[</mo><mi>j</mi><mo>−</mo><mi>P</mi><mi>M</mi><mi>T</mi><mo stretchy=\"false\">[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow></msub></mrow><annotation encoding=\"application/x-tex\">w_{[0...PMT[j-1]-1]} = w_{[j-PMT[j-1]...j-1]}        </annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7857599999999999em;vertical-align:-0.3551999999999999em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">[</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">.</span><span class=\"mord mtight\">.</span><span class=\"mord mtight\">.</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.13889em;\">T</span><span class=\"mopen mtight\">[</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">]</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">]</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7857599999999999em;vertical-align:-0.3551999999999999em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">[</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">−</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.13889em;\">T</span><span class=\"mopen mtight\">[</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">]</span><span class=\"mord mtight\">.</span><span class=\"mord mtight\">.</span><span class=\"mord mtight\">.</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">]</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span></span></span></span></span></span>\n<p>Moreover, through previous comparison we get</p>\n<span title=\"w_{[i-j...i-1]} = w_{[0...j-1]}\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mrow><mo stretchy=\"false\">[</mo><mi>i</mi><mo>−</mo><mi>j</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow></msub><mo>=</mo><msub><mi>w</mi><mrow><mo stretchy=\"false\">[</mo><mn>0...</mn><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow></msub></mrow><annotation encoding=\"application/x-tex\">w_{[i-j...i-1]} = w_{[0...j-1]}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7857599999999999em;vertical-align:-0.3551999999999999em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">[</span><span class=\"mord mathdefault mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mord mtight\">.</span><span class=\"mord mtight\">.</span><span class=\"mord mtight\">.</span><span class=\"mord mathdefault mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">]</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7857599999999999em;vertical-align:-0.3551999999999999em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">[</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">.</span><span class=\"mord mtight\">.</span><span class=\"mord mtight\">.</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">]</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span></span></span></span></span></span>\n<p>Combine this two equations, and we get</p>\n<span title=\"w_{[0...PMT[j-1]-1]} = w_{[i-PMT[j-1]...i-1]}\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mrow><mo stretchy=\"false\">[</mo><mn>0...</mn><mi>P</mi><mi>M</mi><mi>T</mi><mo stretchy=\"false\">[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo>−</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow></msub><mo>=</mo><msub><mi>w</mi><mrow><mo stretchy=\"false\">[</mo><mi>i</mi><mo>−</mo><mi>P</mi><mi>M</mi><mi>T</mi><mo stretchy=\"false\">[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow></msub></mrow><annotation encoding=\"application/x-tex\">w_{[0...PMT[j-1]-1]} = w_{[i-PMT[j-1]...i-1]}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7857599999999999em;vertical-align:-0.3551999999999999em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">[</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">.</span><span class=\"mord mtight\">.</span><span class=\"mord mtight\">.</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.13889em;\">T</span><span class=\"mopen mtight\">[</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">]</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">]</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7857599999999999em;vertical-align:-0.3551999999999999em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">[</span><span class=\"mord mathdefault mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.13889em;\">T</span><span class=\"mopen mtight\">[</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">]</span><span class=\"mord mtight\">.</span><span class=\"mord mtight\">.</span><span class=\"mord mtight\">.</span><span class=\"mord mathdefault mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">]</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span></span></span></span></span></span>\n<p>If we make <code>j = PMT[j-1]</code>, the above equation will turn into</p>\n<span title=\"w_{[0...j-1]} = w_{[i-j...i-1]}\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mrow><mo stretchy=\"false\">[</mo><mn>0...</mn><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow></msub><mo>=</mo><msub><mi>w</mi><mrow><mo stretchy=\"false\">[</mo><mi>i</mi><mo>−</mo><mi>j</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow></msub></mrow><annotation encoding=\"application/x-tex\"> w_{[0...j-1]} = w_{[i-j...i-1]}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7857599999999999em;vertical-align:-0.3551999999999999em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">[</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">.</span><span class=\"mord mtight\">.</span><span class=\"mord mtight\">.</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">]</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7857599999999999em;vertical-align:-0.3551999999999999em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">[</span><span class=\"mord mathdefault mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mord mtight\">.</span><span class=\"mord mtight\">.</span><span class=\"mord mtight\">.</span><span class=\"mord mathdefault mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">]</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span></span></span></span></span></span>\n<p>which is the same as the second equation above! It means by making the shortest move of <code>j</code> back, we will continue to find the longest prefix and suffix with least comparison.</p>\n<h3 id=\"section-next-table\">Next Table</h3>\n<p>Next table is the permutation of PMT.</p>\n<table>\n<thead>\n<tr>\n<th id=\"w\" style=\"text-align:center;\">w</th>\n<th id=\"a\" style=\"text-align:center;\">A</th>\n<th id=\"b\" style=\"text-align:center;\">B</th>\n<th id=\"c\" style=\"text-align:center;\">C</th>\n<th id=\"d\" style=\"text-align:center;\">D</th>\n<th id=\"a\" style=\"text-align:center;\">A</th>\n<th id=\"b\" style=\"text-align:center;\">B</th>\n<th id=\"d\" style=\"text-align:center;\">D</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center;\">PMT</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">1</td>\n<td style=\"text-align:center;\">2</td>\n<td style=\"text-align:center;\">0</td>\n</tr>\n<tr>\n<td style=\"text-align:center;\">Next</td>\n<td style=\"text-align:center;\">-1</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">0</td>\n<td style=\"text-align:center;\">1</td>\n<td style=\"text-align:center;\">2</td>\n</tr>\n</tbody>\n</table>\n<p>It sets <code>Next[0] = -1</code>, and moves PMT right in one step. The purpose of Next table is to make the KMP code more concisely. I will not illustrate it here, as understanding PMT first is the key.</p>"},"postNav":{"previous":"/posts/2019-8-22-pregnancy-delivery","next":"/posts/2019-10-3-algorithm-binary-heap"},"morePosts":[{"slug":"2020-10-7-algorithm-traversal-of-binary-tree","title":"Algorithm Notes: Traversal of Binary Tree","date":"2020-10-07T16:00:00+08:00","locale":"en","readTime":3,"excerpt":"<p>Mostly we know that the traversal of binary tree can be easily done by recursion....</p>"},{"slug":"2020-7-10-algorithm-binary-search","title":"Algorithm Notes: Understanding of Binary Search","date":"2020-07-10T20:00:00+08:00","locale":"en","readTime":4,"excerpt":"<p>Recently, I have recovered my algorithm praticing. It's like something is messing in my mind, maybe due to the shallow...</p>"},{"slug":"2019-10-3-algorithm-binary-heap","title":"Algorithm Notes: Binary Heap","date":"2019-10-03T20:00:00+08:00","locale":"en","readTime":2,"excerpt":"<p>A Binary Heap is a complete Binary Tree. It is either a Min Heap, where parent node's value is less...</p>"},{"slug":"2021-3-14-build-my-website-style","title":"How To Build My Own Website (3) - Style","date":"2021-03-14T20:00:00+08:00","locale":"en","excerpt":"This article illustrates how I style my own website using Tailwindcss framework, make theme color configurable, and apply interactive animations.","readTime":2}]},"__N_SSG":true}